

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Multiphase mechanical equilibrium flows &mdash; ECOGEN 2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Developers" href="Chap6_developersGuide_Chapter.html" />
    <link rel="prev" title="Single-phase test cases" href="Chap5_1Euler.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ECOGEN
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Chap1_introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chap2_installation_Chapter.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chap3_IO_Chapter.html">I/O descriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chap4_tutorials_Chapter.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Chap5_testCases_Chapter.html">Test cases</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Chap5_1Euler.html">Single-phase test cases</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Multiphase mechanical equilibrium flows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#advection-test-cases">Advection test cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#interfacewaterair">interfaceWaterAir</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#shock-tubes">Shock tubes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#interfacewaterair-shock-tube">interfaceWaterAir shock tube</a></li>
<li class="toctree-l4"><a class="reference internal" href="#epoxyspinel">epoxySpinel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#other-tests-cases">Other tests cases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Chap6_developersGuide_Chapter.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chap7_license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chap8_GUI.html">Graphical User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="zBibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ECOGEN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="Chap5_testCases_Chapter.html">Test cases</a> &raquo;</li>
        
      <li>Multiphase mechanical equilibrium flows</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Chap5_2Kapila.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="multiphase-mechanical-equilibrium-flows">
<h1>Multiphase mechanical equilibrium flows<a class="headerlink" href="#multiphase-mechanical-equilibrium-flows" title="Permalink to this headline">¶</a></h1>
<p>Mechanical equilibrium flows are solved in ECOGEN using Kapila’s model <a class="bibtex reference internal" href="zBibliography.html#kapila2001" id="id1">[KMB+01]</a>. In the particular case of 2 phases involved and without any extra physics (surface tension, viscosity…), this model reads:</p>
<div class="math notranslate nohighlight">
\begin{equation}
\label{system_kapila}
\left\{
{\begin{array}{*{20}{l}}
  {\cfrac{{\partial {\alpha _1}}}{{\partial t}} + \mathbf{u} \cdot \nabla {\alpha _1}}&amp;{ = K div( \mathbf{u} ),} \\
  {\cfrac{{\partial {\alpha _1}{\rho _1}}}{{\partial t}} +  div \left( {{\alpha _1}{\rho _1}\mathbf{u}} \right) } &amp;{ = 0 ,} \\
  {\cfrac{{\partial {\alpha _2}{\rho _2}}}{{\partial t}} + div \left( {{\alpha _2}{\rho _2}\mathbf{u}} \right)}&amp;{ = 0 ,} \\
  {\cfrac{{\partial \rho \mathbf{u}}}{{\partial t}} + div \left( {\rho \mathbf{u} \otimes \mathbf{u} + p \mathbf{I}} \right)}&amp;{ = \mathbf{0} ,} \\
  {\cfrac{{\partial \rho E}}{{\partial t}} + div \left( {\left( {\rho E + p} \right) \mathbf{u}} \right)}&amp;{ = 0 ,}
\end{array}} \right.\
\end{equation}</div><p>where subscripts <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(2\)</span> correspond to one of the two phases, respectively. <span class="math notranslate nohighlight">\(\alpha_k\)</span> and <span class="math notranslate nohighlight">\(\rho_k\)</span> are the volume fraction and density of phase <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\rho = \sum\limits_{k} \alpha_k \rho_k\)</span>, <span class="math notranslate nohighlight">\(\mathbf{u}\)</span>, <span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(E = e + \cfrac{1}{2} \| \mathbf{u} \|^2\)</span> and <span class="math notranslate nohighlight">\(e = \sum_k \alpha_k \rho_k e_k\)</span> are the mixture density, velocity, pressure, total energy and internal energy, respectively.</p>
<p>The term <span class="math notranslate nohighlight">\(K div (\mathbf{u})\)</span> accounts for the differences in the acoustic behavior of both phases or in other words, for the differences in expansion and compression of each phase in mixture regions. <span class="math notranslate nohighlight">\(K\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\begin{equation*}
K = \cfrac{\rho _2 s_2^2 - \rho _1 s_1^2}{\cfrac{\rho _2 s_2^2}{\alpha _2} + \cfrac{\rho _1 s_1^2}{\alpha _1}},
\end{equation*}</div><p><span class="math notranslate nohighlight">\(s_k\)</span> being the speed of sound of phase <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>This model is solved thanks to the numerical method presented in <a class="bibtex reference internal" href="zBibliography.html#relaxjcp" id="id2">[SPB09]</a>.</p>
<div class="section" id="advection-test-cases">
<h2>Advection test cases<a class="headerlink" href="#advection-test-cases" title="Permalink to this headline">¶</a></h2>
<p>The code is provided with the following test cases for advections:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/1D/transports/interfaceWaterAir/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/2D/transportWaterSquareInAir/<span class="nt">&lt;/testCase&gt;</span>
</pre></div>
</div>
<div class="section" id="interfacewaterair">
<h3>interfaceWaterAir<a class="headerlink" href="#interfacewaterair" title="Permalink to this headline">¶</a></h3>
<p>This first test case is important since it validates the capacity of the numerical method to treat simple advection of an interface between pure fluid without creating spurious oscillations on pressure or velocity profiles. Input files for this test are available in <em>./libTests/referenceTestCases/kapila/1D/transports/interfaceWaterAir/</em>.</p>
<div class="figure align-center" id="id6">
<span id="fig-testcases-kapila-advection1dci"></span><a class="reference internal image-reference" href="_images/advection1DCI.png"><img alt="_images/advection1DCI.png" src="_images/advection1DCI.png" style="width: 613.1999999999999px; height: 161.7px;" /></a>
<p class="caption"><span class="caption-number">Fig. 22 </span><span class="caption-text">Initial condition for 1D advection of water–air interface.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<p>The initial characteristics of the run are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Characteristic</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>dimension</p></td>
<td><p>1 m</p></td>
</tr>
<tr class="row-odd"><td><p>Mesh size</p></td>
<td><p>800</p></td>
</tr>
<tr class="row-even"><td><p>interface position</p></td>
<td><p>0.3 m</p></td>
</tr>
<tr class="row-odd"><td><p>boundary conditions</p></td>
<td><p>non-reflecting</p></td>
</tr>
<tr class="row-even"><td><p>final solution time</p></td>
<td><p>0.7 ms</p></td>
</tr>
<tr class="row-odd"><td><p>solution printing frequency</p></td>
<td><p>0.025 ms</p></td>
</tr>
<tr class="row-even"><td><p>precision</p></td>
<td><p>1st order</p></td>
</tr>
</tbody>
</table>
<p>In the default test case, the computation is performed with a 1st order scheme. We compare this solution with those obtained using the 2nd order scheme with THINC limiter <a class="bibtex reference internal" href="zBibliography.html#shyue2014thinc" id="id3">[SX14]</a>.</p>
<div class="figure align-center" id="id7">
<span id="fig-testcases-kapila-advection1d"></span><a class="reference internal image-reference" href="_images/advection1D.gif"><img alt="_images/advection1D.gif" src="_images/advection1D.gif" style="width: 749.5px; height: 298.0px;" /></a>
<p class="caption"><span class="caption-number">Fig. 23 </span><span class="caption-text">Advection of a water–air interface. Visualization using <a class="reference external" href="https://www.paraview.org/">Paraview</a> software.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="shock-tubes">
<h2>Shock tubes<a class="headerlink" href="#shock-tubes" title="Permalink to this headline">¶</a></h2>
<p>The test cases relative to Kapila’s model are those presented in <a class="bibtex reference internal" href="zBibliography.html#relaxjcp" id="id4">[SPB09]</a>. They are here reproduced using ECOGEN.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/1D/shockTubes/interfaceWaterAir/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/1D/shockTubes/epoxySpinel/<span class="nt">&lt;/testCase&gt;</span>
</pre></div>
</div>
<div class="section" id="interfacewaterair-shock-tube">
<h3>interfaceWaterAir shock tube<a class="headerlink" href="#interfacewaterair-shock-tube" title="Permalink to this headline">¶</a></h3>
<p>A shock tube between a high-pressure chamber filled with water and a low-pressure chamber filled with air is released. Input files for this test are available in <em>./libTests/referenceTestCases/kapila/1D/shockTubes/interfaceWaterAir/</em>.</p>
<div class="figure align-center" id="id8">
<span id="fig-testcases-kapila-shocktubewaterairci"></span><a class="reference internal image-reference" href="_images/schemaCI.png"><img alt="_images/schemaCI.png" src="_images/schemaCI.png" style="width: 613.1999999999999px; height: 139.29999999999998px;" /></a>
<p class="caption"><span class="caption-number">Fig. 24 </span><span class="caption-text">Initial condition for 1D water–air shock tube.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p>The initial characteristics of the run are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 53%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Characteristic</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>dimension</p></td>
<td><p>1 m</p></td>
</tr>
<tr class="row-odd"><td><p>Initial mesh size / max size</p></td>
<td><p>100 / 230</p></td>
</tr>
<tr class="row-even"><td><p>number of refinement level</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>diaphragm position</p></td>
<td><p>0.7 m</p></td>
</tr>
<tr class="row-even"><td><p>boundary conditions</p></td>
<td><p>non-reflecting</p></td>
</tr>
<tr class="row-odd"><td><p>final solution time</p></td>
<td><p>0.240 ms</p></td>
</tr>
<tr class="row-even"><td><p>solution printing frequency</p></td>
<td><p>0.012 ms</p></td>
</tr>
<tr class="row-odd"><td><p>precision</p></td>
<td><p>2nd order (Vanleer/THINC)</p></td>
</tr>
</tbody>
</table>
<p>AMR technique of <a class="bibtex reference internal" href="zBibliography.html#schmidmayer2019adaptive" id="id5">[SPD19]</a> is used with 4 refinement levels such that a maximum of 230 computational cells are used for this run.</p>
<div class="figure align-center" id="id9">
<span id="fig-testcases-kapila-shocktubewaterair"></span><a class="reference internal image-reference" href="_images/shockTubeWaterAir.gif"><img alt="_images/shockTubeWaterAir.gif" src="_images/shockTubeWaterAir.gif" style="width: 754.0px; height: 411.0px;" /></a>
<p class="caption"><span class="caption-number">Fig. 25 </span><span class="caption-text">Water–air shock tube. Visualization using <a class="reference external" href="https://www.paraview.org/">Paraview</a> software.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="epoxyspinel">
<h3>epoxySpinel<a class="headerlink" href="#epoxyspinel" title="Permalink to this headline">¶</a></h3>
<p>This test deals with shocks in mixture of materials. Epoxy and spinel are supposed mixed such that caracteristic times for wave propagation and drag effects are very small, allowing to consider the mixture as evolving in mechanical equilibrium. Input files for this test are available in <em>./libTests/referenceTestCases/kapila/1D/shockTubes/epoxySpinel/</em>.</p>
<div class="figure align-center" id="id10">
<span id="fig-testcases-kapila-shocktubeepospici"></span><a class="reference internal image-reference" href="_images/schemaCI1.png"><img alt="_images/schemaCI1.png" src="_images/schemaCI1.png" style="width: 613.1999999999999px; height: 139.29999999999998px;" /></a>
<p class="caption"><span class="caption-number">Fig. 26 </span><span class="caption-text">Initial condition for mixture shock tube with epoxy and spinel.</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<p>The initial characteristics of the run are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 59%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Characteristic</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>dimension</p></td>
<td><p>1 m</p></td>
</tr>
<tr class="row-odd"><td><p>Initial mesh size / max size</p></td>
<td><p>200 / 237</p></td>
</tr>
<tr class="row-even"><td><p>number of refinement level</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>diaphragm position</p></td>
<td><p>0.6 m</p></td>
</tr>
<tr class="row-even"><td><p>boundary conditions</p></td>
<td><p>non-reflecting</p></td>
</tr>
<tr class="row-odd"><td><p>final solution time</p></td>
<td><p>0.1 ms</p></td>
</tr>
<tr class="row-even"><td><p>solution printing frequency</p></td>
<td><p>0.025 ms</p></td>
</tr>
<tr class="row-odd"><td><p>precision</p></td>
<td><p>2nd order (Vanleer)</p></td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="id11">
<span id="fig-testcases-kapila-shocktubeepospi"></span><a class="reference internal image-reference" href="_images/shockTubeEpoSpi.gif"><img alt="_images/shockTubeEpoSpi.gif" src="_images/shockTubeEpoSpi.gif" style="width: 754.0px; height: 411.0px;" /></a>
<p class="caption"><span class="caption-number">Fig. 27 </span><span class="caption-text">Mixture shock tube with expoxy and spinel. Visualization using <a class="reference external" href="https://www.paraview.org/">Paraview</a> software.</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="other-tests-cases">
<h2>Other tests cases<a class="headerlink" href="#other-tests-cases" title="Permalink to this headline">¶</a></h2>
<p>Other tests are provided with ECOGEN package. They will soon be described in details.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/1D/cavitation/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/2D/transportWaterSquareInAir/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/2D/squareWaterExplosion/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/2D/shockBubble/heliumAir/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/2D/richtmyerMeshkov/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/2D/testUnstructured/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/Kapila/AddPhysicalEffects/evap/evapShockTube/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/Kapila/AddPhysicalEffects/evap/dodEvapShockTube/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/AddPhysicalEffects/surfaceTension/squareToCircle/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/AddPhysicalEffects/surfaceTension/squareToCircleSymmetry/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/AddPhysicalEffects/surfaceTension/waterCylinderInAir/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/AddPhysicalEffects/surfaceTension/waterDropletInAir/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/AddPhysicalEffects/surfaceTension/dropletImpact/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/AddPhysicalEffects/gravity/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/3D/unstructured/<span class="nt">&lt;/testCase&gt;</span>
<span class="nt">&lt;testCase&gt;</span>./libTests/referenceTestCases/kapila/3D/shockBubble/heliumAir/<span class="nt">&lt;/testCase&gt;</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Chap6_developersGuide_Chapter.html" class="btn btn-neutral float-right" title="Developers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Chap5_1Euler.html" class="btn btn-neutral float-left" title="Single-phase test cases" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, code-mphi

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>